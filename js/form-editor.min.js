!function(epdfGf,undefined){jQuery(document).on("gform_field_added",(function(event,form,field){loadPdfViewerFieldEditorSettings(field)})),void 0!==gform.addAction&&gform.addAction("gform_post_load_field_settings",(function(field,form){loadPdfViewerFieldEditorSettings(field[0])}),10,2);const{__:__}=wp.i18n;var controller=new AbortController;function loadPdfViewerFieldEditorSettings(field){if(epdf_gf_form_editor_strings.field_type===field.type){var elements=[];elements.push(document.getElementById("field_initial_scale"));var keys=[];keys.push("initialScale"),elements[0]&&(elements[0].value=rgar(field,keys[0]),["input","propertychange"].forEach((function(e){elements[0].addEventListener(e,(function(){SetFieldProperty(keys[0],this.value)}))})),elements[0].dispatchEvent(new Event("input"))),elements.push(document.getElementById("field_pdf_url")),keys.push("pdfUrl"),elements[1]&&(elements[1].value=rgar(field,keys[1]),["input","propertychange"].forEach((function(e){elements[1].addEventListener(e,(function(){SetFieldProperty(keys[1],this.value),""!==this.value?!function(string){let url;try{url=new URL(string)}catch(_){return!1}return"http:"===url.protocol||"https:"===url.protocol}(this.value)?setFieldError("pdf_url_setting","below",__("Please enter a valid URL.","embed-pdf-gravityforms")):epdf_gf_form_editor_strings.site_url===this.value.substring(0,epdf_gf_form_editor_strings.site_url.length)?(resetFieldError("pdf_url_setting"),controller.abort(),localFileExists(this.value).then((exists=>exists?resetFieldError("pdf_url_setting"):setFieldError("pdf_url_setting","below",__("No file exists at the provided URL.","embed-pdf-gravityforms"))))):setFieldError("pdf_url_setting","below",__("Only PDFs hosted by this website and other websites listing this website in a CORS header ‘Access-Control-Allow-Origin’ can load in the viewer.","embed-pdf-gravityforms")+'<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">'+__("Learn about CORS →","embed-pdf-gravityforms")+"</a>"):resetFieldError("pdf_url_setting")}))})),elements[1].dispatchEvent(new Event("input"))),elements.push(document.getElementById("choose_pdf_url")),elements[2]&&(elements[2].removeEventListener("click",handleChooseClick),elements[2].addEventListener("click",handleChooseClick))}}const localFileExists=file=>{if(epdf_gf_form_editor_strings.site_url!==file.substring(0,epdf_gf_form_editor_strings.site_url.length))return Promise.resolve(!1);controller=new AbortController;return fetch(file,{method:"HEAD",cache:"no-store",credentials:"omit",signal:controller.signal}).then((response=>200===response.status&&response.url===file)).catch((exception=>!1))};function handleChooseClick(e){if(e.preventDefault(),void 0!==wp.media){var file_frame=wp.media.frames.file_frame=wp.media({title:__("Choose PDF","embed-pdf-gravityforms"),button:{text:__("Load","embed-pdf-gravityforms")},frame:"select",multiple:!1});return file_frame.on("select",(function(){var attachment=file_frame.state().get("selection").first().toJSON(),urlEl=document.getElementById("field_pdf_url");urlEl||(urlEl=document.getElementById("url_pdf")),urlEl&&attachment.url&&(urlEl.value=attachment.url,urlEl.dispatchEvent(new Event("input")))})),file_frame.open(),!1}console.log("[Embed PDF for Gravity Forms] wp.media is undefined.")}}(window.epdfGf=window.epdfGf||{});