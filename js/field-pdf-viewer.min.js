function isValidHttpUrl(string){let url;try{url=new URL(string)}catch(_){return!1}return"http:"===url.protocol||"https:"===url.protocol}function renderPage(epdfInstance,pageNum){epdfInstance.pageRendering=!0,epdfInstance.pdfDoc.getPage(pageNum).then((function(page){var viewport=page.getViewport({scale:epdfInstance.pdfDoc.currentScaleValue});epdfInstance.canvas.height=viewport.height,epdfInstance.canvas.width=viewport.width;var renderContext={canvasContext:epdfInstance.canvas.getContext("2d"),viewport:viewport};page.render(renderContext).promise.then((function(){epdfInstance.pageRendering=!1,null!==epdfInstance.pageNumPending&&(renderPage(epdfInstance,epdfInstance.pageNumPending),epdfInstance.pageNumPending=null),epdfInstance.canvas.style.width="100%",epdfInstance.canvas.style.width=epdfInstance.canvas.width+"px";const event=new CustomEvent("epdf_render_page",{detail:epdfInstance.pageNum});window.dispatchEvent(event)}))})),document.getElementById(epdfInstance.canvasId+"_page_num").textContent=pageNum}function queueRenderPage(epdfInstance){epdfInstance.pageRendering?epdfInstance.pageNumPending=epdfInstance.pageNum:renderPage(epdfInstance,epdfInstance.pageNum)}function onPrevPage(e){var epdfInstance=window["epdf_"+e.target.dataset.viewerId];epdfInstance.pageNum<=1||(epdfInstance.pageNum--,queueRenderPage(epdfInstance),togglePrevNextButtons(epdfInstance))}function onNextPage(e){var epdfInstance=window["epdf_"+e.target.dataset.viewerId];epdfInstance.pageNum>=epdfInstance.pdfDoc.numPages||(epdfInstance.pageNum++,queueRenderPage(epdfInstance),togglePrevNextButtons(epdfInstance))}function togglePrevNextButtons(epdfInstance){document.getElementById(epdfInstance.canvasId+"_prev").disabled=1==epdfInstance.pageNum,document.getElementById(epdfInstance.canvasId+"_next").disabled=epdfInstance.pageNum==epdfInstance.pdfDoc.numPages}function scaleDeltaDefault(){return 1.1}function scaleMin(){return.25}function scaleMax(){return 10}function onZoomIn(e){var epdfInstance=window["epdf_"+e.target.dataset.viewerId];let newScale=epdfInstance.pdfDoc.currentScaleValue;newScale=(newScale*scaleDeltaDefault()).toFixed(2),newScale=Math.ceil(10*newScale)/10,newScale=Math.min(scaleMax(),newScale),epdfInstance.pdfDoc.currentScaleValue=newScale,renderPage(epdfInstance,epdfInstance.pageNum);const event=new CustomEvent("epdf_scale_value",{detail:newScale});window.dispatchEvent(event)}function onZoomOut(e){var epdfInstance=window["epdf_"+e.target.dataset.viewerId];let newScale=epdfInstance.pdfDoc.currentScaleValue;newScale=(newScale/scaleDeltaDefault()).toFixed(2),newScale=Math.floor(10*newScale)/10,newScale=Math.max(scaleMin(),newScale),epdfInstance.pdfDoc.currentScaleValue=newScale,renderPage(epdfInstance,epdfInstance.pageNum);const event=new CustomEvent("epdf_scale_value",{detail:newScale});window.dispatchEvent(event)}function loadPreview(fieldId,formId){var epdfInstance=window["epdf_"+fieldId],fieldElementId="field_"+formId+"_"+fieldId;if(void 0===epdfInstance)return void(epdf_gf_pdf_viewer_strings.script_debug&&console.log("[Embed PDF for Gravity Forms] loadPreview( "+fieldId+" ) failed, spin up data missing"));if(""===epdfInstance.urlPdf)return void(epdf_gf_pdf_viewer_strings.script_debug&&console.log("[Embed PDF for Gravity Forms] loadPreview( "+fieldId+" ) failed, no PDF URL"));const controls={prev:"onPrevPage",next:"onNextPage",zoom_in:"onZoomIn",zoom_out:"onZoomOut"};Object.keys(controls).forEach((function(key,index){var el=document.getElementById(epdfInstance.canvasId+"_"+key);el&&el.addEventListener("click",window[controls[key]])})),pdfjsLib.getDocument({url:epdfInstance.urlPdf,verbosity:0}).promise.then((function(pdfDoc_){epdfInstance.pdfDoc&&epdfInstance.pdfDoc.destroy(),epdfInstance.pdfDoc=pdfDoc_,document.getElementById(epdfInstance.canvasId+"_page_count").textContent=epdfInstance.pdfDoc.numPages,epdfInstance.pdfDoc.currentScaleValue=epdfInstance.initialScale,epdfInstance.canvas.style.width="100%",renderPage(epdfInstance,epdfInstance.pageNum),togglePrevNextButtons(epdfInstance)})).catch((function(error){epdf_gf_pdf_viewer_strings.script_debug&&(console.log("[Embed PDF for Gravity Forms]"),console.log(error));const el=document.querySelector("#"+fieldElementId+" .ginput_container_pdf_viewer");if(el&&error.message){const{__:__}=wp.i18n;var msg="<p><b>"+__("PDF Viewer Error:","embed-pdf-gravityforms")+"</b> "+error.message;epdf_gf_pdfjs_strings.is_user_logged_in&&(msg+=' <a href="https://breakfastco.xyz/embed-pdf-for-gravity-forms/#troubleshooting">'+__("Troubleshooting â†’","embed-pdf-gravityforms")+"</a>"),msg+="</p>",el.innerHTML+=msg}document.querySelectorAll("#"+fieldElementId+" .epdf-controls-container, #"+fieldElementId+" .epdf-container").forEach((function(el){el.style.display="none"}))}))}window.addEventListener("load",(function(e){"undefined"!=typeof pdfjsLib&&(pdfjsLib.GlobalWorkerOptions.workerSrc=epdf_gf_pdfjs_strings.url_worker)}));